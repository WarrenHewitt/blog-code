<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        rect{
            background: red
        }
    </style>
</head>

<body>
    <svg id="svg" xmlns="http://www.hew/1/svg" version="1.0" style="width: 100%; height: 500px;background-color: rgb(5, 216, 216);">

        <!-- <path d="M 310 100, L 310 5, A 700 700 0 0 0 580 100" fill="green" stroke="pink" stroke-width="2"/>
        -->

        <!-- <g transform="translate(500,200)" fill="red">
            <rect x="0" y="0" rx="2" ry="2" width="120" height="30" fill="#E2E2E2"/>
            <text x="30" y="20" fill="red">判断</text>
        </g> -->

        <!-- <g transform="translate(700,400)" fill="red">
            <rect x="0" y="0" rx="2" ry="2" width="120" height="30" fill="#E2E2E2"/>
            <text x="30" y="20" fill="red">1</text>
        </g> -->

        <!-- <g transform="translate(500,200)" fill="red">
            <path d="M 60 31 L 60 50 L 260 50 L260 200" fill="none" stroke="pink" stroke-width="2"/>
        </g> -->

        <!--  -->


        <!-- <g transform="translate(-100,-220)" style="visibility: visible; cursor: row-resize;">
            <path d="M 1722 499 L 1932 499 L 1932 602.63" fill="none" stroke="white" stroke-miterlimit="10" pointer-events="stroke" visibility="hidden" stroke-width="9"></path>
            <path d="M 1722 499 L 1932 499 L 1932 602.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"></path>
            <path d="M 1932 607.88 L 1928.5 600.88 L 1932 602.63 L 1935.5 600.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path>
        </g> -->
    </svg>
    <script>
        var data = [{
            name: 'hew',
            children: [
                { 
                    name: 'warren',
                    children: [
                        { 
                            name: 'name1', 
                            children: [
                                {
                                    name: 'n1'
                                },
                                {
                                    name: 'n2'
                                },
                                {
                                    name: 'n3'
                                },
                            ] 
                        },
                        { 
                            name: 'name2',
                            children: [
                                {
                                    name: 'name2-1'
                                },
                                {
                                    name: 'name2-2',
                                    children: [
                                        {
                                            name: 'name2-1'
                                        },
                                    ]
                                }
                            ]
                        },
                    ]
                }
            ]
        }]

        const svg = document.querySelector('#svg');
        let str = ''
        let path = ''
        let hDelta = 100
        
        function rect(name, left, top) {
            str += `<g transform="translate(${left},${top})" fill="red"> <rect x="0" y="0" rx="2" ry="2" width="120" height="30" fill="#E2E2E2"/> <text x="30" y="20" fill="red">${name}</text></g>`
        }

        function setPath(type, left, top) {
            console.log('---', type, left, top);
            const h = top + hDelta
            const mTop = top + 30
            left = left + 50
            if(type === 1) {
                path += `<path d="M ${left} ${mTop} L ${left} ${h}" fill="none" stroke="pink" stroke-width="2"/>`
            }
        }

        function setEle (d, left, top) {
            if(d.length === 1) {
                const children = d[0].children 
                if(children && children.length > 2) {
                    left = left - 200
                }
                rect(d[0].name, left, top)
                setPath(1, left, top)
                if(children) {
                    top += hDelta
                    setEle(children, left, top)
                }
            } else if (d.length === 2) {
                
                let l0 = left-100
                let nextTop = top + hDelta
                const d0 = d[0].children
                if(d0) {
                    if(d0 && d0.length > 2) {
                        l0 = left - 200
                    }
                    setEle(d0, l0, nextTop)
                }
                rect(d[0].name, l0 , top)

                let l1 = left+100
                const d1 = d[1].children
                if(d1) {
                    if(d1.length > 1) {
                        l1 = left + 200
                    }
                    setEle(d1, l1, nextTop)
                }
                rect(d[1].name, l1 , top)
            } else if (d.length === 3) {
                rect(d[1].name, left - 150, top)
                rect(d[0].name, left, top)
                rect(d[2].name, left + 150, top)
            } else {

            }
        }
        setEle(data, 500, 0)
        
        svg.innerHTML = str + path

       

        // main(reData, data.startNode.id)
        // console.log(reData);
    </script>
</body>

</html>
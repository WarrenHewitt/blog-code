<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <svg xmlns="http://www.hew/1/svg" version="1.0" style="width: 100%; height: 500px;background-color: rgb(5, 216, 216);">
        <circle cx="100" cy="50" r="40" stroke="black" stroke-width="2" fill="red" />
        <path d="M150 0 L75 200 L225 200 Z" />

        <path class="link" conditype="" d="M140,-38L471.0669250488281,28.73231315612793"></path>

        <path d="M 310 100, L 310 5, A 700 700 0 0 0 580 100" fill="green" stroke="pink" stroke-width="2"/>

        <rect x="60" y="10" rx="10" ry="10" width="30" height="30"/>


        <text x="500" y="250" fill="red">文本</text>
    </svg>
    <script>
        const data = {
            startNode: { name: "开始", id: "startEvent1" },
            userNode: [
                {
                    name: "李四任务",
                    id: "cs_1",
                    tasks: [{
                        startTime: "2021-01-12 09:50:47",
                        message: "第1步",
                        userName: "王五",
                        reviewTime: "2021-01-12 09:52:29",
                        status: "已审批"
                    }
                    ]
                },
                {
                    name: "候选用户王五",
                    id: "cs_2",
                    tasks: [
                        {
                            startTime: "2021-01-12 09:52:29",
                            message: "第2步",
                            reviewTime: "2021-01-12 10:14:06",
                            status: "已审批"
                        },
                        {
                            startTime: "2021-01-12 11:06:20",
                            message: "第4步",
                            userName: "测试管理员",
                            reviewTime: "2021-01-12 11:06:56",
                            status: "已审批"
                        }
                    ]
                },
                {
                    name: "候选组测试组",
                    id: "cs_3",
                    tasks: [
                        {
                            startTime: "2021-01-12 10:14:06",
                            message: "第3步",
                            reviewTime: "2021-01-12 10:25:26",
                            status: "已审批"
                        },
                        {
                            startTime: "2021-01-12 10:59:51",
                            message: "第3步",
                            reviewTime: "2021-01-12 11:03:29",
                            status: "已审批"
                        },
                        {
                            startTime: "2021-01-12 11:04:41",
                            message: "第4步",
                            reviewTime: "2021-01-12 11:06:20",
                            status: "已审批"
                        },

                        {
                            startTime: "2021-01-12 11:06:56",
                            message: "第4步",
                            userName: "李四,赵六",
                            reviewTime: "2021-01-12 11:07:14",
                            status: "已审批"
                        }
                    ]
                },
                {
                    name: "候选用户赵六，李四",
                    id: "cs_42",
                    tasks: [
                        {
                            startTime: "2021-01-12 10:25:26",
                            message: "第4步",
                            reviewTime: "2021-01-12 10:59:51",
                            status: "已审批"
                        },
                        {
                            startTime: "2021-01-12 11:03:29",
                            message: "第4步",
                            reviewTime: "2021-01-12 11:04:41",
                            status: "已审批"
                        },
                        {
                            startTime: "2021-01-12 11:07:14",
                            message: "第4步",
                            userName: "李四",
                            reviewTime: "2021-01-12 11:18:29",
                            status: "已审批"
                        }
                    ]
                },
                {
                    name: "王五任务",
                    id: "cs_41",
                    tasks: []
                },
                {
                    name: "李四任务",
                    id: "cs_6",
                    tasks: [
                        {
                            startTime: "2021-01-12 13:47:28",
                            message: "第4步",
                            userName: "赵六",
                            reviewTime: "2021-01-12 13:47:59",
                            status: "已审批"
                        }
                    ]
                },
                {
                    name: "流程发起人",
                    id: "cs_5",
                    tasks: [
                        {
                            startTime: "2021-01-12 11:18:29",
                            message: "第4步",
                            reviewTime: "2021-01-12 13:47:28",
                            status: "已审批"
                        }
                    ]
                }
            ],
            endNode: {
                name: "结束",
                id: "sid-BEDAEB42-74EB-4D9E-AE43-3D4EA89037FA"
            },
            gateway: [
                {
                    name: "判断节点",
                    id: "sid-B75E7605-1757-4E28-AA94-878C769B480B",
                    type: "exclusive"
                },
            ],
            flow: [
                {
                    targetRef: "cs_1",
                    sourceRef: "startEvent1"
                },
                {
                    targetRef: "cs_2",
                    sourceRef: "cs_1"
                },
                {
                    targetRef: "sid-B75E7605-1757-4E28-AA94-878C769B480B",
                    sourceRef: "cs_3"
                },
                {
                    targetRef: "cs_6",
                    sourceRef: "cs_41"
                },
                {
                    targetRef: "cs_5",
                    sourceRef: "cs_42"
                },
                {
                    targetRef: "cs_3",
                    sourceRef: "cs_2"
                },
                {
                    targetRef: "sid-BEDAEB42-74EB-4D9E-AE43-3D4EA89037FA",
                    sourceRef: "cs_6"
                },
                {
                    targetRef: "cs_6",
                    sourceRef: "cs_5"
                },
                {
                    targetRef: "cs_42",
                    sourceRef: "sid-B75E7605-1757-4E28-AA94-878C769B480B"
                },
                {
                    targetRef: "cs_41",
                    sourceRef: "sid-B75E7605-1757-4E28-AA94-878C769B480B"
                }
            ]
        }

        /* 获取当前流程信息及其人员信息 */
        const getFlowPeople = (currentId) => {
            const flow = data.flow.filter(v => v.sourceRef === currentId)
            if(flow.length) {
                flow.forEach(item => {
                    item.people = data.userNode.find(v => v.id === item.targetRef)
                })
                return flow
            } else {
                return false
            }
        }

        const main = (_d, id) => {
            const getData = getFlowPeople(id) 
            if(getData.length) {
                _d.children = getData
                getData.forEach(item => {
                    main(item, item.targetRef)
                })
            }
        }
        const reData = {}
        // main(reData, data.startNode.id)
        // console.log(reData);
    </script>
</body>

</html>
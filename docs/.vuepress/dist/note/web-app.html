<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Warren&#39;s</title>
    <meta name="description" content="blog &amp; note">
    <link rel="icon" href="/blog/favicon.ico">
    
    <link rel="preload" href="/blog/assets/css/0.styles.6581f3a5.css" as="style"><link rel="preload" href="/blog/assets/js/app.9e8c9158.js" as="script"><link rel="preload" href="/blog/assets/js/2.19854088.js" as="script"><link rel="preload" href="/blog/assets/js/56.8358363d.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.ac35b3f5.js"><link rel="prefetch" href="/blog/assets/js/11.8db7a734.js"><link rel="prefetch" href="/blog/assets/js/12.edb1abce.js"><link rel="prefetch" href="/blog/assets/js/13.74ffdcb2.js"><link rel="prefetch" href="/blog/assets/js/14.1829996b.js"><link rel="prefetch" href="/blog/assets/js/15.314ea8c2.js"><link rel="prefetch" href="/blog/assets/js/16.1cc6f283.js"><link rel="prefetch" href="/blog/assets/js/17.a1ba1d59.js"><link rel="prefetch" href="/blog/assets/js/18.f8bca36b.js"><link rel="prefetch" href="/blog/assets/js/19.64dedaf1.js"><link rel="prefetch" href="/blog/assets/js/20.8ea23d8d.js"><link rel="prefetch" href="/blog/assets/js/21.0af6b543.js"><link rel="prefetch" href="/blog/assets/js/22.6c099726.js"><link rel="prefetch" href="/blog/assets/js/23.0e51b530.js"><link rel="prefetch" href="/blog/assets/js/24.178d77bc.js"><link rel="prefetch" href="/blog/assets/js/25.3fdf9ddb.js"><link rel="prefetch" href="/blog/assets/js/26.33037e02.js"><link rel="prefetch" href="/blog/assets/js/27.bf6a3e29.js"><link rel="prefetch" href="/blog/assets/js/28.d88bb07f.js"><link rel="prefetch" href="/blog/assets/js/29.ffdb1715.js"><link rel="prefetch" href="/blog/assets/js/3.5b2a4f6b.js"><link rel="prefetch" href="/blog/assets/js/30.0c372c6d.js"><link rel="prefetch" href="/blog/assets/js/31.d57c2842.js"><link rel="prefetch" href="/blog/assets/js/32.f702bcdf.js"><link rel="prefetch" href="/blog/assets/js/33.75b8c897.js"><link rel="prefetch" href="/blog/assets/js/34.d2c66dca.js"><link rel="prefetch" href="/blog/assets/js/35.88cc9dec.js"><link rel="prefetch" href="/blog/assets/js/36.e093b66f.js"><link rel="prefetch" href="/blog/assets/js/37.19a33e0d.js"><link rel="prefetch" href="/blog/assets/js/38.34160eb0.js"><link rel="prefetch" href="/blog/assets/js/39.f3d5d9e2.js"><link rel="prefetch" href="/blog/assets/js/4.4e2b953c.js"><link rel="prefetch" href="/blog/assets/js/40.077207f7.js"><link rel="prefetch" href="/blog/assets/js/41.aeb1a4a7.js"><link rel="prefetch" href="/blog/assets/js/42.8ddc75d2.js"><link rel="prefetch" href="/blog/assets/js/43.ffcf59e4.js"><link rel="prefetch" href="/blog/assets/js/44.ba22c5ff.js"><link rel="prefetch" href="/blog/assets/js/45.3faa9556.js"><link rel="prefetch" href="/blog/assets/js/46.23436903.js"><link rel="prefetch" href="/blog/assets/js/47.47ce3bcb.js"><link rel="prefetch" href="/blog/assets/js/48.4f56edbb.js"><link rel="prefetch" href="/blog/assets/js/49.4ea5cd47.js"><link rel="prefetch" href="/blog/assets/js/5.eeb56c9b.js"><link rel="prefetch" href="/blog/assets/js/50.9247a94d.js"><link rel="prefetch" href="/blog/assets/js/51.74905b6e.js"><link rel="prefetch" href="/blog/assets/js/52.71b2de59.js"><link rel="prefetch" href="/blog/assets/js/53.4718526b.js"><link rel="prefetch" href="/blog/assets/js/54.9260b0d0.js"><link rel="prefetch" href="/blog/assets/js/55.29408364.js"><link rel="prefetch" href="/blog/assets/js/57.744812c2.js"><link rel="prefetch" href="/blog/assets/js/58.8b0177fe.js"><link rel="prefetch" href="/blog/assets/js/59.cb6fbf99.js"><link rel="prefetch" href="/blog/assets/js/6.c8817c6f.js"><link rel="prefetch" href="/blog/assets/js/60.0852977b.js"><link rel="prefetch" href="/blog/assets/js/61.30f2446c.js"><link rel="prefetch" href="/blog/assets/js/62.533b18af.js"><link rel="prefetch" href="/blog/assets/js/63.e9712de4.js"><link rel="prefetch" href="/blog/assets/js/64.1ad0ad2d.js"><link rel="prefetch" href="/blog/assets/js/65.0c702180.js"><link rel="prefetch" href="/blog/assets/js/66.2ff34b8d.js"><link rel="prefetch" href="/blog/assets/js/67.2a0370e6.js"><link rel="prefetch" href="/blog/assets/js/7.f03a9e7b.js"><link rel="prefetch" href="/blog/assets/js/8.d0157f4d.js"><link rel="prefetch" href="/blog/assets/js/9.2a36f2f4.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.6581f3a5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/logo.png" alt="Warren's" class="logo"> <span class="site-name can-hide">Warren's</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/fe/" class="nav-link">前端</a></div><div class="nav-item"><a href="/blog/be/" class="nav-link">后端</a></div><div class="nav-item"><a href="/blog/note/" class="nav-link router-link-active">笔记</a></div><div class="nav-item"><a href="/blog/other/" class="nav-link">其它</a></div><div class="nav-item"><a href="https://github.com/WarrenHewitt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/fe/" class="nav-link">前端</a></div><div class="nav-item"><a href="/blog/be/" class="nav-link">后端</a></div><div class="nav-item"><a href="/blog/note/" class="nav-link router-link-active">笔记</a></div><div class="nav-item"><a href="/blog/other/" class="nav-link">其它</a></div><div class="nav-item"><a href="https://github.com/WarrenHewitt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>所有</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/note/examination.html" class="sidebar-link">笔试</a></li><li><a href="/blog/note/javascript.html" class="sidebar-link">javascript</a></li><li><a href="/blog/note/html.html" class="sidebar-link">html</a></li><li><a href="/blog/note/css.html" class="sidebar-link">css</a></li><li><a href="/blog/note/react.html" class="sidebar-link">react</a></li><li><a href="/blog/note/vue.html" class="sidebar-link">vue</a></li><li><a href="/blog/note/web-app.html" class="active sidebar-link">web-app</a></li><li><a href="/blog/note/typescript.html" class="sidebar-link">typescript</a></li><li><a href="/blog/note/mini-programe.html" class="sidebar-link">mini-programe</a></li><li><a href="/blog/note/node.html" class="sidebar-link">node</a></li><li><a href="/blog/note/java.html" class="sidebar-link">java</a></li><li><a href="/blog/note/python.html" class="sidebar-link">python</a></li><li><a href="/blog/note/mysql-mongo.html" class="sidebar-link">mysql-mongo</a></li><li><a href="/blog/note/git.html" class="sidebar-link">git</a></li><li><a href="/blog/note/D3.html" class="sidebar-link">D3</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#移动端遇到的问题及处理方式">移动端遇到的问题及处理方式</a></li><li><a href="#移动端相关说明">移动端相关说明</a></li></ul></div> <div class="table-of-contents"><ul><li><a href="#移动端遇到的问题及处理方式">移动端遇到的问题及处理方式</a></li><li><a href="#移动端相关说明">移动端相关说明</a></li></ul></div><p></p> <hr> <h2 id="移动端遇到的问题及处理方式"><a href="#移动端遇到的问题及处理方式" class="header-anchor">#</a> 移动端遇到的问题及处理方式</h2> <ul><li>ios8 以下不支持sessionStorage</li></ul> <hr> <ul><li>input button 标签有：outline</li></ul> <hr> <ul><li>eruda 存在影响页面元素的scroll情况，可能是元素不发滚动</li></ul> <hr> <ul><li>关闭 chrome 的下拉刷新 body 设置css样式 <code>overscroll-behavior-y: contain;</code></li></ul> <hr> <ul><li>获取屏幕宽度，兼容方案</li></ul> <div class="language- extra-class"><pre class="language-text"><code>var w = window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;
</code></pre></div><hr> <ul><li>禁止用户选择
-webkit-user-select: none;
user-select: none;</li></ul> <hr> <ul><li>ios横竖屏切换字体变大
-webkit-text-size-adjust: 100%;</li></ul> <hr> <ul><li>下载app方式 a标签地址
<ol><li>ios: 'itms-apps://itunes.apple.com/cn/app/%E5%87%AF%E5%8A%B1%E7%A8%8B/id840880551?mt=8'</li> <li>android： 直接下载地址</li></ol></li></ul> <hr> <ul><li>打开app
<ol><li>查询app的URL Scheme(如微信的为weixin) &lt; a href=&quot;weixin://&quot; &gt;打开微信&lt; /a&gt;</li></ol></li></ul> <hr> <ul><li>打电话 <code>&lt;a href='tel:1234565'&gt;</code></li></ul> <hr> <ul><li>禁止识别手机号
<ol><li>&lt; meta name=&quot;format-detection&quot; content=&quot;telephone=no&quot;&gt;</li></ol></li></ul> <hr> <ul><li>去掉ios长按时的阴影
<ol><li>*{-webkit-tap-highlight-color: transparent;}</li></ol></li></ul> <hr> <ul><li>兼容iPhoneX
<ol><li>env()替代constant() constant 从iOS11.2 Beta开始会被弃用</li> <li>设置可视窗口大小 viewport-fit=cover|contain|auto</li></ol></li></ul> <div class="language- extra-class"><pre class="language-text"><code>&lt;meta name=&quot;viewport&quot; content=&quot;viewport-fit=cover&quot;&gt; 只能设置cover
body {
  padding-bottom: constant(safe-area-inset-bottom);
  padding-bottom: env(safe-area-inset-bottom);
}
// env() 跟 constant() 需要同时存在，而且顺序不能换
</code></pre></div><hr> <ul><li>ios的 input 有默认的 padding和 margin  以及一些Android会默认有白色背景</li></ul> <hr> <ul><li>页面有滑动时 在 ios 中，底部的白色或黑色的背景被拉上来，没有回弹，是原生框架问题</li></ul> <hr> <ul><li>设置border0.5px  Android 会处理为1px ios 会处理为0.5px</li></ul> <hr> <ul><li>防止滑动穿透(例：阻止 touchmove 的default事件)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>ele<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'touchmove'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>

<span class="token comment">// 如果底部元素内容依然可以滑动， 将底部的元素设置overflow:hidden 关闭弹出层后将其还原</span>
</code></pre></div><hr> <ul><li>调用原生app提供的方法时应该用try catch 来防止报错后整个H5应用崩溃 <strong>注意向前兼容老版本没有app提供的方法</strong></li></ul> <hr> <ul><li>设置或者获取滚动条位置</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token comment">// 其它</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> height <span class="token comment">// ios</span>
</code></pre></div><hr> <ul><li>设置了元素overflow：auto 在 ios 中滚动不流畅，设置-webkit-overflow-scrolling: touch</li></ul> <hr> <ul><li>1px  用scale缩放0.5  达到0.5像素效果</li></ul> <hr> <ul><li>多行文本溢出 box-orient：vertical；line-clamp：2</li></ul> <hr> <ul><li>ios 弹性滚动 over-scroll：touch</li></ul> <hr> <ul><li>click 300ms 延迟</li> <li>tap 300ms延迟导致 底层的元素的cklic事件被触发  所以底层最好也用tap事件</li></ul> <hr> <ul><li>window.location.reload() 在部分Android机型无法指行</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 兼容做法</span>
window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里用 replace 是为了生成新 url，注意不同项目做法会不同</span>
    window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/#.*/g</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <ul><li>ios 在弹出层中双击任意元素，底部页面自动上滑</li></ul> <p>当弹出层出现时，将body(也可能是其它元素)设置如下css，隐藏时置空</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token property">overflow</span><span class="token punctuation">:</span>hidden<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>//<span class="token property">移动端如果只设置overflow</span><span class="token punctuation">:</span>hidden会无效
</code></pre></div><hr> <ul><li>与app交互传递参数时，为保证 ios与 Android都可行，传字符串</li></ul> <hr> <ul><li>当接收的时间字符串有 +0800时，在ios中直接用new Date()方法无效，要将时间字符串中的T改为空格，-改为/</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/iphone/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>appVersion<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    timeString <span class="token operator">=</span> timeString<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/T/g</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    timeString <span class="token operator">=</span> timeString<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/-/g</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="移动端相关说明"><a href="#移动端相关说明" class="header-anchor">#</a> 移动端相关说明</h2> <ul><li>移动端 兼容所有h5</li> <li>基于webview</li> <li>基于webkit</li> <li>定高  宽度百分比   flex  媒体查询</li></ul> <div class="language-css extra-class"><pre class="language-css"><code> <span class="token atrule"><span class="token rule">@media</span> 媒体类型<span class="token punctuation">(</span>screen<span class="token punctuation">,</span>print<span class="token punctuation">)</span> and 媒体特性（max-width）</span><span class="token punctuation">{</span>
     css
 <span class="token punctuation">}</span>
</code></pre></div> <link rel="stylesheet" href="" media="screen and (max-width:320px)"> <p>rem ios6+ android 2.1+</p> <p>px :css pixels 逻辑像素，浏览器使用的抽象单位
dp,pt: device independent pixels 设备独立像素 物理像素
dpr：设备像素缩放比(若为2：等同于页面扩大了一倍，要用initial-scale：0.5变回来) js 用 window.devicePixelRatio 来获取
设备像素比(dpr) ＝ 物理像素 / 设备独立像素
CSS中，可以通过-webkit-device-pixel-ratio，-webkit-min-device-pixel-ratio和 -webkit-max-device-pixel-ratio进行媒体查询，对不同dpr的设备做适配</p> <p>平面上 1px = dpr * dpr * dp
维度上 1px = dpr * dp</p> <p>flex 4.4以上</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/note/vue.html" class="prev">vue</a></span> <span class="next"><a href="/blog/note/typescript.html">typescript</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.9e8c9158.js" defer></script><script src="/blog/assets/js/2.19854088.js" defer></script><script src="/blog/assets/js/56.8358363d.js" defer></script>
  </body>
</html>
